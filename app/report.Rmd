---
title: "Independent t-test Multiverse Report"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: true
    toc_depth: 2
    df_print: paged
    self_contained: true
    code_folding: hide
    highlight: haddock
    theme: flatly
    toc_float: yes
params:
  m1: 10.30
  m2: 8.71
  sd1: 3.12
  sd2: 2.80
  n1: 50
  n2: 48
  m_digits: 2
  sd_digits: 2

  p_operator: "less_than"
  p: 0.05
  p_digits: 3
  p_methods: "student_t"
  alpha: 0.05

  d: 0.53
  d_ci_lower: 0.20
  d_ci_upper: 0.90
  direction: "m1_minus_m2"

  input_rounding: !r NULL
  output_rounding: !r NULL
  d_digits: 2
  hedges_correction: !r NULL
  ci_methods: !r NULL
  include_se_sd_confusion: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo   = FALSE,
  warning = FALSE,
  message = FALSE
)

library(knitr)
library(kableExtra)
library(recalc)

```

# Analysis overview

```{r}
inputs <- data.frame(
  Parameter = c(
    "M1", "M2", "SD1", "SD2", "N1", "N2",
    "m_digits", "sd_digits",
    "p_operator", "Reported p", "p_digits", "p_methods", "alpha",
    "Reported d", "Reported d CI lower", "Reported d CI upper",
    "Direction",
    "Input rounding", "Output rounding", "d_digits",
    "Hedges' correction", "CI method",
    "Include SE/SD confusion"
  ),
  Value = c(
    params$m1, params$m2, params$sd1, params$sd2, params$n1, params$n2,
    params$m_digits, params$sd_digits,
    params$p_operator, params$p, params$p_digits, params$p_methods, params$alpha,
    params$d, params$d_ci_lower, params$d_ci_upper,
    params$direction,
    if (is.null(params$input_rounding)) "NULL" else as.character(params$input_rounding),
    if (is.null(params$output_rounding)) "NULL" else as.character(params$output_rounding),
    params$d_digits,
    if (is.null(params$hedges_correction)) "NULL" else as.character(params$hedges_correction),
    if (is.null(params$ci_methods)) "NULL" else as.character(params$ci_methods),
    as.character(params$include_se_sd_confusion)
  ),
  stringsAsFactors = FALSE
)

kbl(inputs, caption = "Inputs used in this analysis") |>
  kable_styling(full_width = FALSE)

```

# Recalculation and multiverse

```{r}

res <- recalc::independent_t_test_summary(
  m1 = params$m1,
  m2 = params$m2,
  sd1 = params$sd1,
  sd2 = params$sd2,
  n1 = params$n1,
  n2 = params$n2,
  m_digits = params$m_digits,
  sd_digits = params$sd_digits,

  p_operator = params$p_operator,
  p = params$p,
  p_digits = params$p_digits,
  p_methods = params$p_methods,
  alpha = params$alpha,

  d = params$d,
  d_ci_lower = params$d_ci_lower,
  d_ci_upper = params$d_ci_upper,
  direction = params$direction,

  input_rounding = params$input_rounding,
  output_rounding = params$output_rounding,
  d_digits = params$d_digits,
  hedges_correction = params$hedges_correction,
  ci_methods = params$ci_methods,
  include_se_sd_confusion = params$include_se_sd_confusion
)

```

# Reproduced results

```{r}

res$reproduced |>
  kbl(caption = "Reproduced results under the specified analytic choices") |>
  kable_styling(full_width = FALSE)

```

# Multiverse of p-values

```{r}

plot_multiverse_p(res)

```

# Multiverse of p-values

```{r}

plot_multiverse_d(res)

```







